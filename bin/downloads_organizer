#!/bin/bash
#0 * * * * /home/anshup/bin/downloads_organizer &>/dev/null
#redirect all o/p to dev null to avoid sending out any emails
set -x
basedir="$HOME/Downloads"
cd $basedir

cnm() {
  if [ ! -d $basedir ]
    then mkdir -p $basedir
  fi

}

month=`date +%m`
year=`date +%Y`

folderpath="$year/$month"
basedir="$basedir/all/$folderpath"

cnm

depthparam=" -depth 1"
if [ $OSTYPE == "linux-gnu" ]
then
  depthparam=" -maxdepth 1"
fi
if [ ! -d `date +%F` ]
then
  rm dailydownload
  find . ${depthparam} -not -name 'all' -not -name '.*' -exec mv {} ${basedir} \;
  mkdir `date +%F`
  ln -s `date +%F` dailydownload
fi

## Screenshots management

cd ~/Desktop
basedir="$HOME/tmp/screenshots/"
basedir="$basedir/all/$folderpath"


if [[ `ls|grep Screen|wc -l ` -gt 0 ]]
then
  today=`date +%F`
  basedir=$basedir/$today
  cnm
  mv -v Screen* $basedir
fi
